<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=5.0,user-scalable=yes,viewport-fit=cover"/>
<title>üíô Carta de Mesaniversario</title>
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,300;1,400;1,600&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}

/* Mejoras para responsive */
html{
  font-size:16px;
  -webkit-text-size-adjust:100%;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

:root{
  --c1:#a0c4e8;--c2:#6a9cc8;--c3:#3a70a8;--c4:#1a3a7c;--c5:#060b1e;
  --rose:#f4b8c4;--rose2:#e07a92;--gold:#f7d774;--gold2:#c48a00;
  --ink:#c8dcf0;--ink2:#8aaed4;
  --cborder:rgba(100,160,220,.35);
  --sh:rgba(0,10,40,.55);
  --cream:#fffdf8;
}

/* Asegurar que las im√°genes sean responsive */
img,video{
  max-width:100%;
  height:auto;
  display:block;
}

/* Safe area para notch en m√≥viles */
@supports(padding: max(0px)) {
  body {
    padding-left: max(12px, env(safe-area-inset-left));
    padding-right: max(12px, env(safe-area-inset-right));
  }
}

html,body{height:100%;min-height:100dvh}
body{
  font-family:'Cormorant Garamond',serif;
  background:var(--c5);
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  overflow-x:hidden;overflow-y:auto;
  padding:clamp(80px,15vh,150px) 12px clamp(40px,8vh,80px);
  position:relative;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STARRY NIGHT SKY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.sky{
  position:fixed;inset:0;z-index:0;
  background:
    radial-gradient(ellipse at 50% 100%, #0a1535 0%, transparent 60%),
    radial-gradient(ellipse at 80% 20%, #0d1f50 0%, transparent 45%),
    radial-gradient(ellipse at 20% 30%, #080f2e 0%, transparent 40%),
    linear-gradient(180deg, #01040f 0%, #020818 20%, #040e24 45%, #060b1e 70%, #04091a 100%);
}

/* Nebula swirls - Van Gogh style */
.nebula{position:fixed;inset:0;z-index:1;pointer-events:none;overflow:hidden}
.nb{
  position:absolute;border-radius:50%;
  filter:blur(var(--blur,60px));
  opacity:var(--op,.08);
  animation:nbSwirl var(--d,30s) ease-in-out infinite alternate;
}
@keyframes nbSwirl{
  0%{transform:translateX(-3%) translateY(-2%) rotate(0deg) scale(1)}
  100%{transform:translateX(3%) translateY(2%) rotate(6deg) scale(1.08)}
}

/* Star layers */
.sw{position:fixed;inset:0;z-index:2;pointer-events:none}
.st{
  position:absolute;border-radius:50%;background:#fff;
  animation:twk var(--d,3s) ease-in-out infinite;
  animation-delay:var(--dl,0s);
}
.st.big{background:radial-gradient(circle,#fff,rgba(200,230,255,.6));filter:blur(.3px)}
@keyframes twk{
  0%,100%{opacity:.06;transform:scale(.6)}
  50%{opacity:var(--mx,1);transform:scale(1.4)}
}

/* Constellation lines */
.const-svg{position:fixed;inset:0;z-index:2;pointer-events:none;opacity:.18}

/* Shooting stars */
.shw{position:fixed;inset:0;z-index:3;pointer-events:none;overflow:hidden}
.shs{
  position:absolute;
  width:1px;height:clamp(60px,10vh,100px);
  background:linear-gradient(to bottom,transparent,rgba(255,255,255,.95) 50%,rgba(180,220,255,.6) 80%,transparent);
  border-radius:2px;opacity:0;
  animation:sht var(--d,12s) ease-in infinite;
  animation-delay:var(--dl,0s);
}
@keyframes sht{
  0%{opacity:0;transform:translateY(-20px) rotate(var(--a,32deg)) scaleY(.1)}
  3%{opacity:1}
  25%{opacity:0;transform:translateY(220px) rotate(var(--a,32deg)) scaleY(1)}
  100%{opacity:0}
}

/* Moon ‚Äî glowing crescent style */
.moon-wrap{
  position:fixed;z-index:3;
  top:clamp(16px,4vw,40px);right:clamp(18px,5vw,60px);
}
.moon{
  width:clamp(60px,9vw,100px);height:clamp(60px,9vw,100px);
  border-radius:50%;
  background:radial-gradient(circle at 36% 33%,#fffbe0,#f5d870 40%,#c8900a 80%,#7a4800);
  box-shadow:
    0 0 0 1px rgba(255,230,100,.15),
    0 0 30px 8px rgba(247,210,80,.4),
    0 0 80px 30px rgba(247,210,80,.18),
    0 0 160px 60px rgba(247,210,80,.07);
  animation:mpul 5s ease-in-out infinite;
  position:relative;
}
.moon::before{
  content:'';position:absolute;
  top:8%;left:12%;
  width:78%;height:78%;
  border-radius:50%;
  background:radial-gradient(circle at 30% 28%,rgba(255,255,240,.4),transparent 55%);
}
/* crescent shadow */
.moon::after{
  content:'';position:absolute;
  top:-4%;left:12%;
  width:86%;height:86%;
  border-radius:50%;
  background:radial-gradient(circle at 68% 35%,transparent 48%,rgba(0,5,20,.65) 70%);
}
@keyframes mpul{
  0%,100%{box-shadow:0 0 0 1px rgba(255,230,100,.15),0 0 30px 8px rgba(247,210,80,.4),0 0 80px 30px rgba(247,210,80,.18),0 0 160px 60px rgba(247,210,80,.07)}
  50%{box-shadow:0 0 0 2px rgba(255,230,100,.22),0 0 50px 16px rgba(247,210,80,.55),0 0 120px 55px rgba(247,210,80,.25),0 0 220px 90px rgba(247,210,80,.1)}
}

/* Firefly dots */
.fw{position:fixed;inset:0;z-index:4;pointer-events:none}
.fe{
  position:absolute;bottom:-40px;opacity:0;
  font-size:var(--sz,1rem);
  animation:ftup var(--d,14s) ease-in infinite;
  animation-delay:var(--dl,0s);
  filter:drop-shadow(0 0 6px rgba(150,200,255,.7));
}
@keyframes ftup{
  0%{opacity:0;transform:translateY(0) translateX(0) rotate(var(--r1,0deg))}
  8%{opacity:.75}88%{opacity:.1}
  100%{opacity:0;transform:translateY(-94vh) translateX(var(--dx,10px)) rotate(var(--r2,15deg))}
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN SYSTEM ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.screen{
  position:relative;z-index:10;
  width:100%;max-width:640px;
  display:none;flex-direction:column;align-items:center;
  animation:scIn .7s cubic-bezier(.22,1,.36,1) both;
  margin:0 auto;
}
.screen.active{display:flex}
@keyframes scIn{from{opacity:0;transform:translateY(28px) scale(.96)}to{opacity:1;transform:none}}
@keyframes scOut{from{opacity:1}to{opacity:0;transform:scale(.93) translateY(-10px)}}

/* Contenedor con width m√°ximo m√°s flexible */
@media(min-width:641px){
  .screen{max-width:680px}
}
@media(min-width:769px){
  .screen{max-width:720px}
}
@media(min-width:1025px){
  .screen{max-width:760px}
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN 0 ‚Äî ENVELOPE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#s-envelope{
  justify-content:flex-start;align-items:center;
  min-height:100vh;padding:clamp(60px,12vh,120px) 12px clamp(30px,5vh,50px);gap:clamp(24px,5vh,45px);
}

.env-wrapper{
  position:relative;
  width:min(88vw,360px);
  cursor:pointer;user-select:none;
  -webkit-tap-highlight-color:transparent;
  animation:envBob 4s ease-in-out infinite;
}
@keyframes envBob{0%,100%{transform:translateY(0)}50%{transform:translateY(-12px)}}
.env-wrapper:hover{animation:none;transform:translateY(-8px) scale(1.03)}
.env-wrapper.opening{animation:envOpen 1s cubic-bezier(.4,0,.2,1) forwards!important}
@keyframes envOpen{0%{transform:translateY(0)}40%{transform:translateY(-10px) scale(1.04)}100%{transform:translateY(-35px) scale(.88);opacity:0}}

.env-body{
  width:100%;
  background:linear-gradient(150deg,rgba(12,22,60,.9),rgba(8,18,50,.95));
  border:1px solid rgba(100,150,220,.4);
  border-radius:4px 4px 14px 14px;
  box-shadow:0 14px 60px rgba(0,0,30,.7),0 0 0 1px rgba(100,150,220,.15),inset 0 1px 0 rgba(100,160,255,.2);
  overflow:hidden;aspect-ratio:1.6/1;
  position:relative;
}
.env-body::before{
  content:'';position:absolute;inset:0;
  background:
    linear-gradient(135deg,rgba(100,160,220,.06) 49.8%,transparent 50%),
    linear-gradient(225deg,rgba(100,160,220,.06) 49.8%,transparent 50%);
  pointer-events:none;
}

.seal{
  position:absolute;top:50%;left:50%;
  transform:translate(-50%,-50%);
  width:clamp(56px,14vw,72px);height:clamp(56px,14vw,72px);
  border-radius:50%;
  background:radial-gradient(circle at 38% 35%,#5a90c8,#1e4d8c 55%,#0a1f5c);
  box-shadow:0 4px 20px rgba(30,77,140,.7),0 0 0 3px rgba(100,160,255,.25),0 0 40px rgba(80,140,220,.3);
  display:flex;align-items:center;justify-content:center;
  font-size:clamp(1.5rem,4vw,1.9rem);
  animation:sealPulse 3s ease-in-out infinite;
  z-index:3;
}
@keyframes sealPulse{
  0%,100%{box-shadow:0 4px 20px rgba(30,77,140,.7),0 0 0 3px rgba(100,160,255,.25),0 0 40px rgba(80,140,220,.3)}
  50%{box-shadow:0 4px 30px rgba(30,77,140,.9),0 0 0 6px rgba(100,160,255,.15),0 0 70px rgba(80,140,220,.5)}
}

.env-flap{
  position:absolute;top:-1px;left:-1px;right:-1px;
  height:55%;
  clip-path:polygon(0% 0%,100% 0%,50% 72%);
  background:linear-gradient(180deg,rgba(14,26,70,.96),rgba(10,20,58,.92));
  border:1px solid rgba(100,150,220,.3);
  transform-origin:top center;
  transform:rotateX(0deg);
  transition:transform .85s cubic-bezier(.4,0,.2,1);
  transform-style:preserve-3d;
  z-index:4;
}
.env-wrapper.flap-open .env-flap{
  transform:perspective(600px) rotateX(-178deg);
}
.env-flap::after{
  content:'';position:absolute;bottom:0;left:0;right:0;height:2px;
  background:linear-gradient(to right,transparent,rgba(100,160,220,.4),transparent);
}

.env-letter-peek{
  position:absolute;bottom:6px;left:10px;right:10px;
  height:0;overflow:hidden;
  transition:height .6s cubic-bezier(.22,1,.36,1) .5s;z-index:5;
}
.env-wrapper.flap-open .env-letter-peek{height:42px}
.env-letter-peek-inner{
  background:linear-gradient(135deg,rgba(12,22,65,.95),rgba(8,18,55,.9));
  border:1px solid rgba(100,160,220,.3);
  border-radius:4px 4px 0 0;height:46px;
  display:flex;align-items:center;justify-content:center;
  font-family:'Dancing Script',cursive;
  font-size:.88rem;color:var(--c1);
  letter-spacing:.05em;
}

.env-hint{
  margin-top:clamp(16px,3vh,24px);
  font-family:'Dancing Script',cursive;
  font-size:clamp(1rem,3vw,1.15rem);
  color:rgba(160,196,232,.7);text-align:center;
  animation:hintPulse 2.5s ease-in-out infinite;
}
@keyframes hintPulse{0%,100%{opacity:.45;transform:scale(1)}50%{opacity:1;transform:scale(1.04)}}
.env-to{
  margin-top:7px;
  font-family:'Cormorant Garamond',serif;font-style:italic;
  font-size:clamp(.82rem,2.5vw,.95rem);
  color:rgba(160,196,232,.38);text-align:center;
}

.env-sparkle{
  position:absolute;font-size:.9rem;
  animation:spkl var(--d,3s) ease-in-out infinite;
  animation-delay:var(--dl,0s);pointer-events:none;
}
@keyframes spkl{0%,100%{opacity:.15;transform:scale(.7)}50%{opacity:.8;transform:scale(1.3) rotate(15deg)}}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN 1 ‚Äî MUSIC ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#s-music{gap:0;padding:0 8px}

.music-card{
  width:100%;
  background:linear-gradient(150deg,rgba(8,16,50,.93),rgba(6,12,40,.96));
  backdrop-filter:blur(20px);
  border:1px solid rgba(100,150,220,.3);
  border-radius:22px;
  box-shadow:0 16px 60px rgba(0,5,30,.8),0 0 0 1px rgba(100,150,220,.1),inset 0 1px 0 rgba(100,160,255,.15);
  padding:clamp(24px,5vw,40px) clamp(18px,6vw,44px);
  position:relative;overflow:hidden;
}
.music-card::before{
  content:'';position:absolute;inset:0;pointer-events:none;
  background:
    radial-gradient(ellipse at 80% 15%,rgba(60,100,180,.1) 0%,transparent 55%),
    radial-gradient(ellipse at 15% 85%,rgba(200,120,160,.07) 0%,transparent 50%);
}

.music-title{
  font-family:'Dancing Script',cursive;font-weight:700;
  font-size:clamp(1.5rem,4vw + 0.5rem,2.6rem);
  text-align:center;line-height:1.2;margin-bottom:4px;
  background:linear-gradient(135deg,#5a9fd4,#a0c8f0,#e07a92);
  background-size:200%;
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  animation:shimmer 5s ease-in-out infinite;
}
.music-sub{
  font-family:'Cormorant Garamond',serif;font-style:italic;
  font-size:clamp(.82rem,1.8vw + 0.2rem,1rem);color:var(--ink2);
  text-align:center;margin-bottom:22px;opacity:.75;
}
@keyframes shimmer{0%,100%{background-position:0 50%}50%{background-position:100% 50%}}

/* Pre-loaded song display */
.preloaded-song{
  background:linear-gradient(135deg,rgba(40,70,130,.4),rgba(20,40,90,.5));
  border:1px solid rgba(100,150,220,.3);
  border-radius:14px;padding:16px 18px;margin-bottom:16px;
  display:flex;align-items:center;gap:14px;
}
.ps-icon{font-size:1.8rem;flex-shrink:0;animation:psIco 2s ease-in-out infinite}
@keyframes psIco{0%,100%{transform:scale(1)}50%{transform:scale(1.12)}}
.ps-info{flex:1;min-width:0}
.ps-name{
  font-family:'Dancing Script',cursive;font-weight:700;
  font-size:clamp(1rem,3vw,1.2rem);color:var(--c1);
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.ps-meta{font-family:'Cormorant Garamond',serif;font-style:italic;font-size:.82rem;color:var(--ink2);opacity:.7;margin-top:2px}

/* Visualizer bars */
.visualizer{display:flex;align-items:flex-end;justify-content:center;gap:4px;height:44px;margin:4px 0}
.vbar{
  width:clamp(4px,1.2vw,7px);border-radius:3px;
  background:linear-gradient(to top,var(--c3),var(--c1));
  height:8px;
  animation:vb var(--d,.6s) ease-in-out infinite alternate;
  animation-delay:var(--dl,0s);
  animation-play-state:paused;
}
.vbar.playing{animation-play-state:running}
@keyframes vb{0%{height:5px}100%{height:var(--h,28px)}}

.progress-row{display:flex;align-items:center;gap:10px}
.time-label{font-family:'Dancing Script',cursive;font-size:.82rem;color:var(--ink2);white-space:nowrap;min-width:36px}
.time-label.right{text-align:right}
.prog-wrap{flex:1;height:5px;background:rgba(100,150,220,.18);border-radius:10px;cursor:pointer;overflow:hidden}
.prog-fill{height:100%;border-radius:10px;background:linear-gradient(to right,var(--c3),var(--c1));transition:width .2s linear;width:0%}

.controls-row{display:flex;align-items:center;justify-content:center;gap:14px}
.ctrl-btn{
  background:none;border:none;cursor:pointer;
  font-size:1.1rem;color:var(--ink2);padding:8px;
  transition:all .2s;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
}
.ctrl-btn:hover{color:var(--c1);transform:scale(1.15)}
.play-btn{
  width:clamp(52px,12vw,62px);height:clamp(52px,12vw,62px);
  background:linear-gradient(135deg,var(--c4),var(--c3),var(--c2));
  border-radius:50%;border:none;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 6px 22px rgba(20,60,160,.5),0 0 0 3px rgba(100,150,220,.2);
  transition:all .3s cubic-bezier(.34,1.56,.64,1);
  font-size:clamp(1.2rem,4vw,1.5rem);color:#fff;
}
.play-btn:hover{transform:scale(1.12);box-shadow:0 10px 32px rgba(20,60,160,.65),0 0 0 6px rgba(100,150,220,.25)}

.vol-row{display:flex;align-items:center;gap:10px}
.vol-row span{font-size:1rem;opacity:.7}
input[type=range]{
  -webkit-appearance:none;appearance:none;
  flex:1;height:3px;background:rgba(100,150,220,.25);border-radius:10px;outline:none;
}
input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;width:13px;height:13px;
  background:var(--c2);border-radius:50%;cursor:pointer;
  box-shadow:0 0 8px rgba(100,150,220,.5);
}

.btn-continue{
  display:flex;align-items:center;justify-content:center;gap:8px;
  width:100%;padding:14px 20px;margin-top:6px;
  background:linear-gradient(135deg,var(--c4),var(--c3),rgba(200,100,140,.7));
  border:none;border-radius:50px;cursor:pointer;
  font-family:'Dancing Script',cursive;font-weight:700;
  font-size:clamp(1rem,3vw,1.15rem);color:#fff;
  box-shadow:0 6px 26px rgba(20,60,160,.45),0 0 0 1px rgba(100,150,220,.2);
  transition:all .3s cubic-bezier(.34,1.56,.64,1);
  letter-spacing:.04em;
}
.btn-continue:hover{transform:translateY(-3px) scale(1.02);box-shadow:0 14px 36px rgba(20,60,160,.55)}
.btn-continue.skip{
  background:transparent;color:rgba(160,196,232,.45);
  box-shadow:none;border:1px solid rgba(100,150,220,.2);
  font-size:.9rem;padding:9px 20px;
}
.btn-continue.skip:hover{color:rgba(160,196,232,.8);background:rgba(100,150,220,.06)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN 2 ‚Äî LETTER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
#s-letter{gap:0;padding:0 8px}

.env-strip{
  width:calc(100% - 6px);max-width:634px;height:26px;
  background:linear-gradient(135deg,rgba(10,22,65,.88),rgba(8,16,52,.8));
  border:1px solid rgba(100,150,220,.28);
  display:flex;align-items:center;justify-content:center;gap:5px;
}
.env-strip.top{border-bottom:none;border-radius:14px 14px 0 0}
.env-strip.bot{border-top:none;border-radius:0 0 14px 14px}
.es-dot{width:5px;height:5px;border-radius:50%;background:var(--c2);box-shadow:0 0 8px rgba(100,160,220,.7)}
.es-line{flex:1;height:1px;background:linear-gradient(to right,transparent,rgba(100,150,220,.3),transparent);max-width:55px}

.letter-card{
  width:100%;
  background:linear-gradient(150deg,rgba(6,12,40,.95),rgba(5,10,36,.98));
  border:1px solid rgba(100,150,220,.25);border-top:none;border-bottom:none;
  padding:clamp(24px,5.5vw,50px) clamp(18px,6.5vw,52px);
  position:relative;overflow:hidden;
  display:flex;flex-direction:column;
}
/* Subtle star-line texture */
.letter-card::before{
  content:'';position:absolute;inset:0;pointer-events:none;z-index:0;
  background:
    radial-gradient(ellipse at 80% 20%,rgba(60,100,180,.08) 0%,transparent 55%),
    radial-gradient(ellipse at 20% 80%,rgba(180,100,140,.06) 0%,transparent 50%),
    repeating-linear-gradient(transparent,transparent 28px,rgba(100,150,220,.05) 29px);
}

.lc-content{position:relative;z-index:1;flex:1;display:flex;flex-direction:column;gap:0}

/* Corner ornaments */
.orn{position:absolute;z-index:2;width:clamp(36px,6vw,58px);height:clamp(36px,6vw,58px);opacity:.3;pointer-events:none}
.orn svg{width:100%;height:100%}
.orn-tl{top:10px;left:10px}
.orn-tr{top:10px;right:10px;transform:scaleX(-1)}
.orn-bl{bottom:50px;left:10px;transform:scaleY(-1)}
.orn-br{bottom:50px;right:10px;transform:scale(-1,-1)}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MEDIA PANEL ‚Äî ARREGLADO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.media-panel{
  width:100%;
  border-radius:14px;
  overflow:hidden;
  border:1px solid rgba(100,150,220,.25);
  background:#060b1e;
  margin-top:24px;
  margin-bottom:0;
  position:relative;
  flex-shrink:0;
  /* Sin altura fija ‚Äî se adapta a la imagen */
  display:flex;
  align-items:center;
  justify-content:center;
}

/* La imagen muestra completa, sin recortes */
.media-panel img,
.media-panel video{
  width:100%;
  height:auto;           /* altura autom√°tica seg√∫n proporci√≥n */
  max-height:none;       /* sin l√≠mite de altura que corte */
  object-fit:contain;    /* muestra completa, sin cortar */
  display:block;
  border-radius:14px;
}

/* vignette overlay */
.media-panel::after{
  content:'';
  position:absolute;
  inset:0;
  border-radius:14px;
  pointer-events:none;
  background:linear-gradient(
    to bottom,
    rgba(0,5,20,.08) 0%,
    transparent 40%,
    transparent 60%,
    rgba(0,5,20,.35) 100%
  );
}

.media-placeholder{
  display:flex;flex-direction:column;align-items:center;gap:8px;
  color:rgba(100,150,220,.5);padding:40px 20px;
  font-family:'Dancing Script',cursive;font-size:1rem;
}
.media-placeholder span{font-size:2rem}
.media-panel .media-label{
  position:absolute;bottom:8px;right:12px;
  font-family:'Dancing Script',cursive;font-size:.78rem;
  color:rgba(160,200,240,.5);z-index:2;letter-spacing:.04em;
  text-shadow:0 0 8px rgba(0,5,30,.8);
}

/* Page typography */
.pg-lbl{font-family:'Dancing Script',cursive;font-size:clamp(.74rem,2vw,.88rem);color:var(--c2);text-align:right;margin-bottom:4px;opacity:.6}
.pg-ttl{
  font-family:'Dancing Script',cursive;font-weight:700;
  font-size:clamp(1.6rem,3.5vw + 0.5rem,2.7rem);
  text-align:center;line-height:1.15;margin-bottom:4px;
  background:linear-gradient(135deg,#5a9fd4,#a0c8f0,#e07a92,#f7d774);
  background-size:200%;
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  animation:shimmer 6s ease-in-out infinite;
}
.divider{display:flex;align-items:center;gap:clamp(8px,2vw,10px);margin:6px 0 14px}
.dline{flex:1;height:1px;background:linear-gradient(to right,transparent,rgba(100,150,220,.4),transparent)}
.dicon{font-size:clamp(.85rem,2vw,.92rem)}
.lbody{
  font-family:'Cormorant Garamond',serif;
  font-size:clamp(.94rem,2vw + 0.2rem,1.13rem);
  font-style:italic;color:var(--ink);line-height:1.9;flex:1;
}
.lbody p{margin-bottom:.85em}
.lbody p:last-child{margin-bottom:0}
.lbody strong{font-style:normal;font-weight:600;color:var(--c1)}
.hi{font-style:normal;font-weight:600;background:linear-gradient(to right,var(--c1),var(--rose2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.qbox{
  background:linear-gradient(135deg,rgba(60,100,180,.16),rgba(180,100,140,.1));
  border-left:2px solid rgba(100,150,220,.5);border-radius:0 10px 10px 0;
  padding:10px 16px;margin:10px 0;
  font-size:clamp(.88rem,2.3vw,1.02rem);color:var(--ink2);font-style:italic;
}
.sig{
  font-family:'Dancing Script',cursive;font-weight:700;
  font-size:clamp(1.5rem,4.5vw,2.1rem);
  color:var(--c1);text-align:right;margin-top:14px;
  filter:drop-shadow(0 0 12px rgba(100,160,255,.4));
}
.cvr-heart{
  text-align:center;font-size:clamp(2.2rem,7vw,3.5rem);margin-bottom:8px;
  animation:hbt 2s ease-in-out infinite;
  filter:drop-shadow(0 0 18px rgba(100,160,255,.8));
}
@keyframes hbt{0%,100%{transform:scale(1)}14%{transform:scale(1.22)}28%{transform:scale(1)}42%{transform:scale(1.1)}70%{transform:scale(1)}}
.badge{
  display:inline-flex;align-items:center;gap:6px;
  background:linear-gradient(135deg,rgba(40,70,160,.4),rgba(20,45,110,.5));
  border:1px solid rgba(100,150,220,.38);color:var(--c1);
  font-family:'Dancing Script',cursive;font-size:clamp(.84rem,2.5vw,.96rem);font-weight:500;
  padding:5px 18px;border-radius:50px;margin:0 auto 14px;
  box-shadow:0 4px 16px rgba(20,60,160,.3),inset 0 1px 0 rgba(100,160,255,.15);
}
.ctr{display:flex;justify-content:center}

/* Header section styling */
.header-section{
  text-align:center;
  margin-top:clamp(40px,8vh,80px);
  margin-bottom:clamp(20px,4vh,32px);
  position:relative;
  z-index:11;
}

.main-title{
  font-family:'Dancing Script',cursive;
  font-weight:700;
  font-size:clamp(1.6rem,4.5vw + 0.5rem,2.8rem);
  background:linear-gradient(135deg,#a0c8f0,#d4eeff,#e07a92,#f7d774);
  background-size:200%;
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  animation:shimmer 5s ease-in-out infinite;
  line-height:1.3;
  letter-spacing:.02em;
  filter:drop-shadow(0 0 20px rgba(100,160,255,.35));
  margin-bottom:8px;
}

.subtitle{
  font-family:'Cormorant Garamond',serif;
  font-style:italic;
  font-size:clamp(.8rem,1.8vw + 0.2rem,.98rem);
  color:rgba(160,196,232,.5);
  margin-top:6px;
  letter-spacing:.06em;
}

.cover-photo-wrapper{
  margin-top:clamp(18px,4vh,28px);
  position:relative;
  width:min(75vw,260px);
  margin-left:auto;
  margin-right:auto;
}

.cover-photo-container{
  border-radius:50%;
  overflow:hidden;
  width:100%;
  padding-bottom:100%; /* mantiene aspecto 1:1 */
  position:relative;
  border:2px solid rgba(100,160,220,.35);
  box-shadow:0 0 0 5px rgba(100,150,220,.08),0 0 30px 8px rgba(80,130,220,.25),0 0 70px 20px rgba(80,130,220,.1);
  animation:coverPulse 4s ease-in-out infinite;
}

.cover-photo-container img{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
  border-radius:50%;
}

.cover-photo-vignette{
  position:absolute;
  inset:0;
  border-radius:50%;
  background:radial-gradient(circle,transparent 55%,rgba(6,11,30,.55) 100%);
  pointer-events:none;
}

.cover-photo-ring{
  position:absolute;
  inset:-6px;
  border-radius:50%;
  border:1px solid rgba(100,160,220,.2);
  animation:ringGlow 3s ease-in-out infinite;
  pointer-events:none;
}

@keyframes coverPulse{
  0%,100%{box-shadow:0 0 0 5px rgba(100,150,220,.08),0 0 30px 8px rgba(80,130,220,.25),0 0 70px 20px rgba(80,130,220,.1)}
  50%{box-shadow:0 0 0 8px rgba(100,150,220,.12),0 0 50px 16px rgba(80,130,220,.4),0 0 110px 40px rgba(80,130,220,.18)}
}

@keyframes ringGlow{
  0%,100%{transform:scale(1);opacity:.3}
  50%{transform:scale(1.06);opacity:.7}
}

/* ‚îÄ‚îÄ Responsive ‚îÄ‚îÄ */

/* Pantallas muy peque√±as (m√≥viles peque√±os) */
@media(max-width:360px){
  body{padding:clamp(50px,10vh,80px) 6px clamp(25px,5vh,40px)}
  .letter-card,.music-card{padding:16px 12px}
  .orn{display:none}
  #s-envelope{padding:clamp(40px,8vh,70px) 6px clamp(20px,4vh,35px);gap:clamp(20px,4vh,35px)}
  .cover-photo-wrapper{width:min(85vw,200px)}
  .header-section{margin-top:clamp(25px,5vh,50px)}
  .main-title{font-size:clamp(1.5rem,5.5vw,2.2rem)}
  .subtitle{font-size:clamp(.78rem,2.3vw,.88rem)}
  .env-wrapper{width:min(92vw,340px)}
  .env-hint{font-size:clamp(.9rem,2.8vw,1.05rem)}
  .env-to{font-size:clamp(.75rem,2.2vw,.85rem)}
}

/* M√≥viles normales */
@media(min-width:361px) and (max-width:480px){
  body{padding:clamp(60px,12vh,100px) 8px clamp(30px,6vh,50px)}
  .letter-card,.music-card{padding:18px 14px}
  .orn{display:none}
  #s-envelope{padding:clamp(50px,10vh,90px) 8px clamp(25px,4vh,40px);gap:clamp(22px,4.5vh,38px)}
  .cover-photo-wrapper{width:min(80vw,220px)}
  .header-section{margin-top:clamp(30px,6vh,60px)}
}

/* Tablets peque√±as en portrait */
@media(min-width:481px) and (max-width:768px){
  body{padding:clamp(70px,13vh,110px) 12px clamp(35px,7vh,60px)}
  #s-envelope{padding:clamp(55px,11vh,95px) 12px clamp(28px,5vh,45px)}
  .cover-photo-wrapper{width:min(65vw,280px)}
  .letter-card,.music-card{padding:clamp(26px,5vw,42px) clamp(20px,6vw,46px)}
  .header-section{margin-top:clamp(35px,7vh,70px)}
}

/* Tablets grandes y escritorio peque√±o */
@media(min-width:769px) and (max-width:1024px){
  body{padding:clamp(80px,14vh,130px) 16px clamp(40px,8vh,70px)}
  #s-envelope{padding:clamp(60px,12vh,100px) 16px clamp(30px,6vh,50px)}
  .cover-photo-wrapper{width:min(50vw,300px)}
  .header-section{margin-top:clamp(40px,8vh,75px)}
}

/* Escritorio grande */
@media(min-width:1025px){
  body{padding:clamp(90px,15vh,150px) 20px clamp(45px,9vh,80px)}
  #s-envelope{padding:clamp(65px,13vh,120px) 20px clamp(35px,7vh,60px)}
  .cover-photo-wrapper{width:min(40vw,320px)}
  .header-section{margin-top:clamp(45px,9vh,80px)}
}

/* Altura muy peque√±a (landscape en m√≥vil) */
@media(max-height:500px) and (orientation:landscape){
  body{padding:clamp(20px,4vh,35px) 12px clamp(15px,3vh,25px)}
  .letter-card{padding:10px 18px}
  .music-card{padding:16px 20px}
  .lbody{font-size:.9rem;line-height:1.65}
  .cvr-heart{font-size:1.6rem}
  #s-envelope{min-height:auto;padding:clamp(20px,4vh,35px) 12px clamp(12px,2.5vh,20px);gap:clamp(10px,2vh,16px)}
  .cover-photo-wrapper{width:min(55vw,160px)}
  .header-section{margin-top:clamp(15px,3vh,28px);margin-bottom:clamp(10px,2vh,16px)}
  .main-title{font-size:clamp(1.4rem,5vw,2rem)}
  .env-wrapper{width:min(75vw,300px)}
  .orn{display:none}
}

/* Altura peque√±a - media */
@media(min-height:501px) and (max-height:680px){
  body{padding:clamp(50px,10vh,80px) 12px clamp(25px,5vh,45px)}
  #s-envelope{padding:clamp(40px,8vh,70px) 12px clamp(20px,4vh,35px);gap:clamp(18px,3.5vh,28px)}
  .header-section{margin-top:clamp(25px,5vh,50px);margin-bottom:clamp(16px,3vh,24px)}
  .cover-photo-wrapper{width:min(70vw,220px);margin-top:clamp(14px,3vh,22px)}
}

/* Altura media */
@media(min-height:681px) and (max-height:900px){
  body{padding:clamp(60px,12vh,100px) 12px clamp(30px,6vh,50px)}
  #s-envelope{padding:clamp(50px,10vh,85px) 12px clamp(25px,5vh,42px)}
  .header-section{margin-top:clamp(30px,6vh,60px)}
}

/* Pantallas muy altas */
@media(min-height:901px){
  body{padding:clamp(80px,15vh,150px) 12px clamp(40px,8vh,80px)}
  #s-envelope{padding:clamp(60px,12vh,120px) 12px clamp(30px,6vh,60px)}
  .header-section{margin-top:clamp(40px,8vh,80px)}
  .cover-photo-wrapper{margin-top:clamp(20px,4vh,35px)}
}

/* iPads espec√≠ficos */
@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (orientation: portrait) {
  .cover-photo-wrapper{width:min(60vw,280px)}
  .env-wrapper{width:min(75vw,380px)}
}

@media only screen 
  and (min-device-width: 768px) 
  and (max-device-width: 1024px) 
  and (orientation: landscape) {
  body{padding:clamp(50px,10vh,80px) 16px clamp(30px,6vh,50px)}
  #s-envelope{gap:clamp(16px,3vh,24px)}
  .cover-photo-wrapper{width:min(45vw,240px)}
}

/* iPhone SE y similares */
@media only screen 
  and (device-width: 375px) 
  and (device-height: 667px) {
  .cover-photo-wrapper{width:min(75vw,220px)}
  #s-envelope{padding:clamp(45px,9vh,75px) 10px clamp(22px,4.5vh,38px)}
}

/* iPhone 12/13/14 Pro Max y similares */
@media only screen 
  and (min-device-width: 414px) 
  and (max-device-width: 430px) {
  .cover-photo-wrapper{width:min(70vw,240px)}
  .env-wrapper{width:min(85vw,360px)}
}

/* Ajustes para touch devices */
@media (hover: none) and (pointer: coarse) {
  .env-wrapper{
    -webkit-tap-highlight-color:transparent;
    touch-action:manipulation;
  }
  .play-btn, .ctrl-btn, .btn-continue{
    min-height:44px;
    min-width:44px;
  }
  .prog-wrap{
    height:8px;
  }
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
  /* Ya est√° oscuro por defecto */
}

/* Reduce motion para accesibilidad */
@media (prefers-reduced-motion: reduce) {
  *,*::before,*::after{
    animation-duration:0.01ms !important;
    animation-iteration-count:1 !important;
    transition-duration:0.01ms !important;
  }
}

/* Print styles */
@media print {
  body{background:#fff}
  .sky,.nebula,.sw,.const-svg,.shw,.moon-wrap,.fw{display:none}
  .screen{page-break-inside:avoid}
}
</style>
</head>
<body>

<!-- BG LAYERS -->
<div class="sky"></div>
<div class="nebula" id="nebula"></div>
<div class="sw" id="stars"></div>
<!-- SVG Constellations -->
<svg class="const-svg" id="constSvg" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid slice"></svg>
<div class="shw" id="shoots"></div>
<div class="moon-wrap"><div class="moon"></div></div>
<div class="fw" id="floats"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN 0 ‚Äî ENVELOPE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen active" id="s-envelope">
  
  <div class="header-section">
    <p class="main-title">
      Feliz 7 meses<br/>mi amor üíô
    </p>
    <p class="subtitle">
      ~ siete mesesitos con utte miamor ~
    </p>

    <div class="cover-photo-wrapper">
      <div class="cover-photo-container">
        <img src="img1.jpg" alt="foto portada"
          onerror="this.parentElement.parentElement.style.display='none'"/>
        <div class="cover-photo-vignette"></div>
      </div>
      <div class="cover-photo-ring"></div>
    </div>
  </div>

  <div class="env-wrapper" id="envWrap" onclick="openEnvelope()">

    <div class="env-sparkle" style="top:-16px;left:18px;--d:3s;--dl:0s">‚ú®</div>
    <div class="env-sparkle" style="top:-20px;right:22px;--d:3.5s;--dl:.7s">üí´</div>
    <div class="env-sparkle" style="bottom:8px;left:-18px;--d:2.7s;--dl:1.1s">‚≠ê</div>
    <div class="env-sparkle" style="bottom:6px;right:-15px;--d:4s;--dl:.4s">üåü</div>
    <div class="env-sparkle" style="top:42%;left:-24px;--d:3.2s;--dl:1.6s">üíô</div>
    <div class="env-sparkle" style="top:38%;right:-22px;--d:2.9s;--dl:.9s">üåô</div>

    <div class="env-body">
      <div class="env-flap" id="envFlap"></div>
      <div class="seal">üíô</div>
    </div>

    <div class="env-letter-peek" id="envPeek">
      <div class="env-letter-peek-inner">‚ú¶ &nbsp; Carta de Mesaniversario &nbsp; ‚ú¶</div>
    </div>
  </div>

  <p class="env-hint">üíå Toca para abrir tu carta üíå</p>
  <p class="env-to">con todo el amor , para utteee‚Ä¶</p>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN 1 ‚Äî MUSIC ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="s-music">
  <div class="music-card">
    <p class="music-title">üéµ Una cancion que me recuerda a ti</p>
    <p class="music-sub">La m√∫sica que acompa√±ar√° esta carta‚Ä¶</p>

    <audio id="audioEl" src="SHES.mp3" preload="auto"></audio>

    <div class="preloaded-song">
      <span class="ps-icon">üé∂</span>
      <div class="ps-info">
        <div class="ps-name" id="songDisplayName">una canci√≥n especial</div>
        <div class="ps-meta">‚ô™ &nbsp; She's The One - Robbie Williams</div>
      </div>
    </div>

    <div class="visualizer" id="visualizer"></div>

    <div class="progress-row" style="margin-bottom:10px">
      <span class="time-label" id="timeCur">0:00</span>
      <div class="prog-wrap" id="progWrap">
        <div class="prog-fill" id="progFill"></div>
      </div>
      <span class="time-label right" id="timeTot">0:00</span>
    </div>

    <div class="controls-row" style="margin-bottom:12px">
      <button class="ctrl-btn" onclick="skipBack()" title="‚àí10s">‚èÆ</button>
      <button class="play-btn" id="playBtn" onclick="togglePlay()">‚ñ∂</button>
      <button class="ctrl-btn" onclick="skipFwd()" title="+10s">‚è≠</button>
    </div>

    <button class="btn-continue" style="margin-top:6px" onclick="goToLetter()">Abrir la carta üíô ‚Üí</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN 2 ‚Äî LETTER (single page) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="screen" id="s-letter">

  <div class="env-strip top">
    <div class="es-line"></div><div class="es-dot"></div>
    <div class="es-line" style="max-width:14px"></div>
    <span style="font-size:.65rem;opacity:.5;color:#6a9cc8">üíå</span>
    <div class="es-line" style="max-width:14px"></div>
    <div class="es-dot"></div><div class="es-line"></div>
  </div>

  <div class="letter-card">

    <!-- Ornaments -->
    <div class="orn orn-tl"><svg viewBox="0 0 64 64" fill="none"><path d="M4 60C4 4 4 4 60 4" stroke="#5a90c8" stroke-width="1.2" fill="none" stroke-dasharray="3 2.5"/><circle cx="7" cy="7" r="3.5" fill="#5a90c8" opacity=".8"/><circle cx="17" cy="5" r="1.5" fill="#a0c4e8"/><circle cx="5" cy="17" r="1.5" fill="#a0c4e8"/><circle cx="26" cy="5" r="1" fill="#f7d774" opacity=".7"/></svg></div>
    <div class="orn orn-tr"><svg viewBox="0 0 64 64" fill="none"><path d="M4 60C4 4 4 4 60 4" stroke="#5a90c8" stroke-width="1.2" fill="none" stroke-dasharray="3 2.5"/><circle cx="7" cy="7" r="3.5" fill="#5a90c8" opacity=".8"/><circle cx="17" cy="5" r="1.5" fill="#a0c4e8"/><circle cx="5" cy="17" r="1.5" fill="#a0c4e8"/></svg></div>
    <div class="orn orn-bl"><svg viewBox="0 0 64 64" fill="none"><path d="M4 60C4 4 4 4 60 4" stroke="#5a90c8" stroke-width="1.2" fill="none" stroke-dasharray="3 2.5"/><circle cx="7" cy="7" r="3.5" fill="#5a90c8" opacity=".8"/><circle cx="5" cy="17" r="1.5" fill="#a0c4e8"/></svg></div>
    <div class="orn orn-br"><svg viewBox="0 0 64 64" fill="none"><path d="M4 60C4 4 4 4 60 4" stroke="#5a90c8" stroke-width="1.2" fill="none" stroke-dasharray="3 2.5"/><circle cx="7" cy="7" r="3.5" fill="#5a90c8" opacity=".8"/><circle cx="5" cy="17" r="1.5" fill="#a0c4e8"/></svg></div>

    <div class="lc-content">

      <!-- Header -->
      <div class="cvr-heart">üíô</div>
      <div class="ctr"><div class="badge">‚ú® &nbsp; Un mes juntos &nbsp; ‚ú®</div></div>
      <h1 class="pg-ttl">Para ti,<br/>mi amor eterno</h1>
      <div class="divider"><div class="dline"></div><span class="dicon">üåô</span><div class="dline"></div></div>

      <!-- Letter body -->
      <div class="lbody">
        <p>Holaaa amorcito de mi corazon feliz siete mesesitos juntos miamor . Paso volando el tiempo vivimos y pasamos muchaaaas cosas , pero cada momento contigo esta guardado en mi  <strong>corazon</strong></p>

        <p>se que muchas cosas me equivoco , no soy la mejor persona pero intento mejorar por nosotros por todo lo que es esto,dudo de muchas cosas que talvez no deberia ,  pero si de algo estoy segurisisisisisimo esque te amo muxo demasiado exagradamente diria yo y de eso nunca lo dudes tu</p>

        <div class="qbox">aunque las monta√±as cambien de lugar y los cerros se vengan abajo mi amor por ti no cambiara Isaias 54:10</div>

        <p> Te dedico ese peque√±o versiculo amor .                 <br><strong>AMORCITO</strong> lamentablemente la vida no es como queremos pero depende de mi ,de ti ,de cada uno con que ojos vemos el dia a dia,quiero que sepas algo amorcito y lo recuerdes NUNCA TE VOY A DEJAR SOLA estare contigo en cada etapa ,en cada momento,en cada locura , en cada enojo en todo miamor tu me tienes ami , soy capaz de vestirme de payaso con tal de verte feliz jasjjahj  olvida eso jaja.</p>

        <p>poco a poco me di de cuenta que hay que agradecer por las cosas que tenemos y las personas que nos acompa√±an yo agradesco de tenerte a mi lado porque realmente tu me haces muy Feliz 
          .yoooo vivo muy feliz sabiendo que tengo el privilegio de tenerte 
        
        </p>

        <p> <strong>gracias amorcito por tu amor , tu poca paciencia jajaj , y tu compa√±ia , aveces las palabras no alcanzan para decirte lo mucho que te amo ,pero nunca dudes del amor que te tengo mini√±a, daria lo que fuera por ti .TE AMO</strong>.</p>
      </div>

      <div class="sig">Con amor Axel  üíô</div>

      <!-- MEDIA PANEL AL FINAL --
      <div class="media-panel" id="mediaPanel" style="margin-top:24px;margin-bottom:0">

        <!-- OPCI√ìN A: IMAGEN -->
        <img id="mediaImg" src="img2.jpg" alt="Nuestro recuerdo"
             onerror="this.style.display='none';document.getElementById('mediaPlaceholder').style.display='flex'"/>

        <!-- OPCI√ìN B: VIDEO ‚Äî descomenta esto y comenta el <img> de arriba -->
        <!--
        <video id="mediaVid" src="tu-video.mp4" autoplay muted loop playsinline
               onerror="this.style.display='none';document.getElementById('mediaPlaceholder').style.display='flex'">
        </video>
        -->

        <!-- Placeholder si no hay media cargada -->
        <div class="media-placeholder" id="mediaPlaceholder" style="display:none">
          <span>üñºÔ∏è</span>
          <span>Agrega tu foto o video<br/>desde el c√≥digo</span>
        </div>

        <div class="media-label">‚ú¶ nuestro recuerdo ‚ú¶</div>
      </div>
    </div>
  </div>

  <div class="env-strip bot"></div>
</div><!-- /s-letter -->

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BG GENERATION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
(()=>{
  // Nebula clouds
  const nb=document.getElementById('nebula');
  [
    {w:'70%',h:'40%',t:'2%',l:'-8%',bg:'rgba(40,70,160,.14)',blur:70,d:28,op:.14},
    {w:'55%',h:'30%',t:'0%',l:'35%',bg:'rgba(80,50,140,.1)',blur:90,d:34,op:.1},
    {w:'45%',h:'28%',t:'5%',l:'60%',bg:'rgba(100,140,200,.09)',blur:65,d:22,op:.09},
    {w:'38%',h:'22%',t:'1%',l:'15%',bg:'rgba(160,80,120,.07)',blur:80,d:26,op:.07}
  ].forEach((b,i)=>{
    const el=document.createElement('div');el.className='nb';
    el.style.cssText=`width:${b.w};height:${b.h};top:${b.t};left:${b.l};background:${b.bg};--blur:${b.blur}px;--d:${b.d}s;--op:${b.op};animation-delay:${-i*7}s`;
    nb.appendChild(el);
  });

  // Stars
  const sw=document.getElementById('stars');
  for(let i=0;i<220;i++){
    const s=document.createElement('div');s.className='st'+(Math.random()>.85?' big':'');
    const z=Math.random()*2.8+0.4,mx=Math.random()>.5?.9:1;
    s.style.cssText=`width:${z}px;height:${z}px;top:${Math.random()*78}%;left:${Math.random()*100}%;--d:${1.5+Math.random()*5}s;--dl:${-Math.random()*8}s;--mx:${mx}`;
    sw.appendChild(s);
  }

  // Constellation SVG
  const svg=document.getElementById('constSvg');
  const clusters=[
    [[580,90],[620,140],[570,150],[640,180],[590,210],[650,220],[600,250]],
    [[150,60],[180,90],[210,70],[240,100],[270,75]],
    [[900,55],[940,80],[980,65],[1020,90],[1010,140],[1010,180],[1010,220]],
    [[400,120],[430,95],[460,125],[440,155],[410,148]]
  ];
  clusters.forEach(pts=>{
    for(let i=0;i<pts.length-1;i++){
      const [x1,y1]=pts[i],[x2,y2]=pts[i+1];
      const line=document.createElementNS('http://www.w3.org/2000/svg','line');
      line.setAttribute('x1',x1);line.setAttribute('y1',y1);
      line.setAttribute('x2',x2);line.setAttribute('y2',y2);
      line.setAttribute('stroke','rgba(180,220,255,.55)');line.setAttribute('stroke-width','0.8');
      svg.appendChild(line);
    }
    pts.forEach(([cx,cy])=>{
      const c=document.createElementNS('http://www.w3.org/2000/svg','circle');
      c.setAttribute('cx',cx);c.setAttribute('cy',cy);
      c.setAttribute('r',Math.random()*1.4+0.8);
      c.setAttribute('fill','rgba(220,240,255,.85)');
      svg.appendChild(c);
    });
  });

  // Shooting stars
  const shw=document.getElementById('shoots');
  for(let i=0;i<10;i++){
    const s=document.createElement('div');s.className='shs';
    s.style.cssText=`top:${Math.random()*35}%;left:${Math.random()*80}%;--a:${24+Math.random()*30}deg;--d:${9+Math.random()*16}s;--dl:${-Math.random()*28}s`;
    shw.appendChild(s);
  }

  // Float emojis
  const fw=document.getElementById('floats');
  const em=['üíô','üåô','‚≠ê','‚ú®','üí´','üåü','üíô','ü©µ','üíô','üå†'];
  for(let i=0;i<20;i++){
    const el=document.createElement('div');el.className='fe';
    el.textContent=em[Math.floor(Math.random()*em.length)];
    const dx=(Math.random()-.5)*50;
    el.style.cssText=`left:${3+Math.random()*93}%;--sz:${.65+Math.random()*.85}rem;--d:${10+Math.random()*15}s;--dl:${-Math.random()*22}s;--r1:${-18+Math.random()*36}deg;--r2:${-18+Math.random()*36}deg;--dx:${dx}px`;
    fw.appendChild(el);
  }

  // Visualizer bars
  const viz=document.getElementById('visualizer');
  const heights=[10,20,32,42,36,28,40,34,24,14,26,38,30,20,12,28,38,44,32,20];
  for(let i=0;i<20;i++){
    const b=document.createElement('div');b.className='vbar';
    b.style.cssText=`--d:${.28+Math.random()*.5}s;--dl:${i*.042}s;--h:${heights[i]||18}px`;
    viz.appendChild(b);
  }
})();

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREEN FLOW ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>{
    if(s.classList.contains('active')){
      s.style.animation='scOut .5s ease both';
      setTimeout(()=>{s.classList.remove('active');s.style.animation='';},480);
    }
  });
  setTimeout(()=>{
    const t=document.getElementById(id);
    t.style.animation='scIn .7s cubic-bezier(.22,1,.36,1) both';
    t.classList.add('active');
  },310);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ENVELOPE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function openEnvelope(){
  const w=document.getElementById('envWrap');
  if(w.dataset.opened)return;
  w.dataset.opened='1';
  w.classList.add('flap-open');
  setTimeout(()=>{
    w.classList.add('opening');
    setTimeout(()=>showScreen('s-music'),720);
  },920);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MUSIC PLAYER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const audio=document.getElementById('audioEl');
let isPlaying=false;

audio.addEventListener('loadedmetadata',()=>{
  document.getElementById('timeTot').textContent=fmtTime(audio.duration);
});
audio.addEventListener('error',()=>{
  console.warn('Audio source not found. Add your mp3 file.');
});

function togglePlay(){
  if(!audio.src)return;
  if(isPlaying){audio.pause();isPlaying=false;}
  else{audio.play().catch(()=>{});isPlaying=true;}
  updatePlayBtn();
}
function updatePlayBtn(){
  document.getElementById('playBtn').textContent=isPlaying?'‚è∏':'‚ñ∂';
  document.querySelectorAll('.vbar').forEach(v=>{
    v.classList.toggle('playing',isPlaying);
  });
}
function skipBack(){audio.currentTime=Math.max(0,audio.currentTime-10)}
function skipFwd(){audio.currentTime=Math.min(audio.duration||0,audio.currentTime+10)}
function fmtTime(s){const m=Math.floor(s/60);return m+':'+(Math.floor(s%60)+'').padStart(2,'0')}

audio.addEventListener('timeupdate',()=>{
  if(!audio.duration)return;
  const pct=(audio.currentTime/audio.duration)*100;
  document.getElementById('progFill').style.width=pct+'%';
  document.getElementById('timeCur').textContent=fmtTime(audio.currentTime);
});
audio.addEventListener('ended',()=>{isPlaying=false;updatePlayBtn()});
document.getElementById('progWrap').addEventListener('click',function(e){
  if(!audio.duration)return;
  const r=this.getBoundingClientRect();
  audio.currentTime=((e.clientX-r.left)/r.width)*audio.duration;
});
audio.volume=0.8;

function goToLetter(){
  showScreen('s-letter');
}
</script>
</body>
</html>